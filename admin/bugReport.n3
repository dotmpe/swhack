@prefix cal: <http://www.w3.org/2002/12/cal/ical#> .
@prefix bst: <bugstatus#> .
@prefix str: <http://www.w3.org/2000/10/swap/string#>.
@prefix log: <http://www.w3.org/2000/10/swap/log#>.

"0" log:outputString """<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <title>Cwm Bug Status - Chronological</title>
    <link href="../doc/style.css" rel="stylesheet" type="text/css" />
</head>
<body>
<h1><a href="../../doc/cwm">Cwm</a> Bug Status</h1>
<p>
This is a chronological listing of known bugs, open or closed, in
<a href="../../doc/cwm">Cwm</a>.  Bugs are registerd by sending mail to
public-cwm-bugs@w3.org. Please use a good summary of the bug as
a subject line. If replying, keep the same subject line ("Re:" is Ok).
To close, reply to the raiser and the list,
inserting "[closed] " at the front of the subject line.
</p>
<ul>
""".

"99" log:outputString """</ul></body></html>""".


{
  ?E cal:summary ?DESC;
    a cal:Vtodo;
    cal:url [ log:uri ?PGI];
    cal:dtstart [ cal:dateTime ?WHEN ].
  (?WHEN ?PGI "1") str:concatenation ?KS.
  (?WHEN ?PGI "5") str:concatenation ?KE.
  ("<li>" ?WHEN " raised: <a href='" ?PGI
       "'>" ?DESC "</a>") str:concatenation ?TXT.
} => {
 ?KS log:outputString ?TXT.
 ?KE log:outputString "</li>\n".
 }.


{
  ?E cal:summary ?DESC;
    a cal:Vtodo;
    cal:url [ log:uri ?PGI];
    cal:completed [ cal:dateTime ?WHEN ].
  (?WHEN ?PGI "7") str:concatenation ?K.
  ("<li>" ?WHEN " <a href='" [is log:uri of ?PGI]
       "'>" ?DESC "</a> closed.</li>\n") str:concatenation ?TXT.
} => { ?K log:outputString ?TXT }.

{
  ?E cal:summary ?DESC;
    a cal:Vtodo;
    cal:url [ log:uri ?PGI];
    cal:dtstart [ cal:dateTime ?WHEN1 ];
    cal:completed [ cal:dateTime ?WHEN2 ].
  (?WHEN1 ?PGI "2") str:concatenation ?K.
  ("<br /><b>closed: " ?WHEN2 "</b>") str:concatenation ?TXT.
} => { ?K log:outputString ?TXT }.



