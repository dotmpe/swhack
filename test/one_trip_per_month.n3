@keywords is, of, a.

@prefix : <one_trip_per_month#>.
@prefix trav: <one_trip_per_month#>.

@prefix s: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix owl: <http://www.w3.org/2002/07/owl#>.
@prefix dt: <http://www.w3.org/2001/XMLSchema#>.

@prefix str: <http://www.w3.org/2000/10/swap/string#>.
@prefix math: <http://www.w3.org/2000/10/swap/math#>.

@prefix cal: <http://www.w3.org/2002/12/cal/icaltzd#>.
@prefix foaf: <http://xmlns.com/foaf/0.1/>.
@prefix k: <http://www.cyc.com/2004/06/04/cyc#>.


DanC a foaf:Person, OneTripPerMonthAgent.

WWW2007
  cal:dtstart "2006-05-08"^^dt:date;
  cal:dtend "2006-05-12"^^dt:date;
  cal:attendee DanC.

XTech
  cal:dtstart "2006-05-15"^^dt:date;
  cal:dtend "2006-05-18"^^dt:date;
  cal:attendee DanC.


RestrictedPersonMonth s:subClassOf PersonMonth,
   [ owl:onProperty trip; owl:maxCardinality 1 ].



###
# axioms for PersonMonth, OneTripPerMonthAgent
{ ?WHO a foaf:Person.
  ?WHEN a k:CalendarMonth
} => {
  ?WHEN k:temporallySubsumes [
    a PersonMonth;
    is k:subAbstractions of ?WHO ].
}.


{
  ?WHO_WHEN a PersonMonth.
  ?WHO a OneTripPerMonthAgent;
    k:subAbstractions ?WHO_WHEN
} => { ?WHO_WHEN a RestrictedPersonMonth }.

###
# Relate Cyc to iCalendar; e.g. YearFn and MonthFn to cal:dtstart

{ ?E cal:dtstart ?WHEN.
  # we skip the dtlit step of splitting ?WHEN apart
  (?WHEN "(\\d\\d\\d\\d)-" ) str:search (?YYYY).
  (?YYYY 0) math:sum ?YEARNUM.
} => { [ is k:YearFn of ?YEARNUM ] }.

{ ?E cal:dtstart ?WHEN.
  (?WHEN "(\\d\\d\\d\\d)-" ) str:search (?YYYY).
  (?YYYY 0) math:sum [ k:YearFn ?YEAR].
} => { ?E k:startsDuring ?YEAR }.

{ ?E cal:dtstart ?WHEN.
  (?WHEN "(\\d\\d\\d\\d)-(\\d\\d)-" ) str:search (?YYYY ?MM).
  (?YYYY 0) math:sum [ k:YearFn ?YEAR].
  (?MM 0) math:sum [ k:MonthOfYearFn ?MONTH_TYPE].
} => {
 (?MONTH_TYPE ?YEAR) k:MonthFn [].
 }.

{ ?E cal:dtstart ?WHEN.
  (?WHEN "(\\d\\d\\d\\d)-(\\d\\d)-" ) str:search (?YYYY ?MM).
  (?YYYY 0) math:sum [ k:YearFn ?YEAR].
  (?MM 0) math:sum [ k:MonthOfYearFn ?MONTH_TYPE].
  (?MONTH_TYPE ?YEAR) k:MonthFn ?MONTH.
} => {
 ?E k:startsDuring ?MONTH.
 }.

{ ?E cal:attendee [ k:subAbstractions ?WHO_WHEN];
     k:temporalBoundsIntersect ?WHO_WHEN.
} => { ?WHO_WHEN trip ?E }.


####
# a bit of Cyc
<> s:seeAlso <http://www.cyc.com/cycdoc/vocab/time-vocab.html>.


k:YearFn s:range k:CalendarYear.
k:MonthFn s:range k:CalendarMonth.
k:MonthOfYearFn s:range k:MonthOfYearType.

k:temporallyDisjoint s:subPropertyOf owl:differentFrom.

5 k:MonthOfYearFn k:May.

k:startsDuring s:subPropertyOf k:temporalBoundsIntersect.
k:temporallySubsumes s:subPropertyOf k:temporalBoundsSubsume,
 k:temporallyIntersect.

k:temporalBoundsSubsume s:subPropertyOf k:temporalBoundsIntersect.
k:temporalBoundsIntersect a owl:SymmetricProperty.

{ ?E k:temporalBoundsIntersect ?BIG.
  ?BIG k:temporalBoundsSubsume ?LITTLE }
 => { ?E k:temporalBoundsIntersect ?LITTLE }.


{ ?E1 cal:dtend [ str:lessThan [ is cal:dtstart of ?E2 ] ]
} => { ?E1 k:temporallyDisjoint ?E2 }.


###
# A bit of OWL
{ ?S ?P ?O1, ?O2.
  ?S a [ owl:onProperty ?P; owl:maxCardinality 1]
} => { ?O1 = ?O2 }.

{ ?P a owl:SymmetricProperty.
  ?S ?P ?O. } => { ?O ?P ?S }.

{ ?P a owl:TransitiveProperty.
  ?S ?P [ ?P ?O]. } => { ?S ?P ?O }.

{ ?S ?P [ owl:sameAs ?O ] } => { ?S ?P ?O }.
owl:sameAs a owl:SymmetricProperty.

###
# A bit of RDFS
{ ?S a [ s:subClassOf ?C ] } => { ?S a ?C }.
{ [] [ s:range ?C] ?O } => { ?O a ?C }.
{ ?S [ s:subPropertyOf ?P ] ?O } => { ?S ?P ?O }.

